Первые 12 байтов в обоих пакетах являются нулями и отвечают за канальный уровень - MAC-адреса. Далее 2 байта определяют тип IP. Следующие байты отвечают за сетевой уровень: 1 байт - длина заголовка, 1 байт - сервисное поле, 2 байта - длина пакета, 2 байта - идентификатор, 2 байта - флаги и отступ фрагмента, 1 байт - время жизни. В конце 1 байт на определение типа транспортного протокола - UDP, 2 байта на контрольную сумму, 4 байта под IP-адрес отправителя и 4 под IP-адрес получателя. Далее транспортный уровень: 2 байта под порт-источник, 2 под порт-получатель, 2 под длину датаграммы, 2 под контрльную сумму. Наконец, последние 6 (5) байтов - отправленная строка.

Пакеты от клиента и сервера отличаются, во-первых, длиной отправляемого сообщения [исправлено, теперь длина одинаковая]; во-вторых, меняются местами порты получателя и отправителя; в-третьих, меняются контрольная сумма и идентификатор.
